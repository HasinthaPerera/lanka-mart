<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lanka Mart - Admin</title>
    <style>
        body { font-family: sans-serif; background-color: #f4f4f4; padding: 20px; }
        #dashboard-content { display: none; } 
        #loading { font-size: 1.5rem; text-align: center; margin-top: 50px; }
    </style>
</head>
<body>

    <div id="loading">Verifying Admin Access...</div>

    <div id="dashboard-content">
        <h1>Admin Dashboard</h1>
        <p>Welcome, <span id="admin-display"></span></p>
        <button id="logout-btn">Logout</button>
        
        <hr>
        <h2>Add Product</h2>
    </div>

    <script type="module">
        // 1. Import Firebase SDKs
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        // 2. Import your keys and email from your local file
        
        import { firebaseConfig, ADMIN_EMAIL } from './config.js';

        // 3. Initialize
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // 4. Security Check
        onAuthStateChanged(auth, (user) => {
            const loading = document.getElementById('loading');
            const dashboard = document.getElementById('dashboard-content');

            if (user && user.email === ADMIN_EMAIL) {
                // Access Granted
                loading.style.display = 'none';
                dashboard.style.display = 'block';
                document.getElementById('admin-display').textContent = user.email;
            } else {
                // Access Denied
                alert("You are not authorized to view this page.");
                window.location.href = "index.html"; // Go back home
            }
        });

        // 5. Logout Logic
        document.getElementById('logout-btn').addEventListener('click', () => {
            signOut(auth).then(() => {
                window.location.href = "index.html";
            });
        });
    </script>
</body>
</html>