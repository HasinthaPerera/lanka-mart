<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lanka-Mart - Fresh Market Online</title>
  
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link rel="stylesheet" href="index.css" />
</head>
<body>

  <header>
    <div class="container">
      <div class="logo-wrapper">
        <h1 class="logo">Lanka<span class="highlight">-Mart</span></h1>
      </div>
      <nav>
        <ul class="nav-links" id="navLinks"> 
          <li><a href="index.html" class="active">Home</a></li>
          <li><a href="products.html">Products</a></li>
          <li><a href="cart.html">Cart</a></li>
          <li><a href="contact.html">Contact</a></li>
          <li><a href="login.html" id="auth-link"><i class="fas fa-user"></i> Login</a></li>
        </ul>
        
        <div class="hamburger" id="hamburger"> 
          <i class="fas fa-bars"></i>
        </div>
      </nav>
    </div>
  </header>

  <main>
    <section class="hero">
      <div class="hero-overlay"></div>
      <div class="container hero-content">
        <h2>Freshness Delivered <br> To Your Doorstep</h2>
        <p>Experience the taste of premium, locally sourced Sri Lankan produce.</p>
        <div class="hero-buttons">
          <a href="products.html" class="btn btn-primary">Shop Now <i class="fas fa-shopping-basket"></i></a>
          <a href="contact.html" class="btn btn-outline">Contact Us</a>
        </div>
      </div>
    </section>

    <section class="about-story">
      <div class="container">
        <div class="about-grid">
          <div class="about-image">
            <img src="Images/farmer.webp" alt="Our Farmer" onerror="this.src='https://via.placeholder.com/400x300'">
          </div>
          <div class="about-text">
            <h4>Our Story</h4>
            <h2>Empowering Local Farmers</h2>
            <p>Lanka-Mart started with a simple mission: to connect the hardworking farmers of Sri Lanka directly with your kitchen. By cutting out the middlemen, we ensure you get the freshest produce at fair prices, while our farmers earn what they deserve.</p>
            <a href="products.html" class="btn btn-primary">Support Local</a>
          </div>
        </div>
      </div>
    </section>

    <section class="categories">
      <div class="container">
        <h2 class="section-title">Shop by Category</h2>
        <div class="category-grid">
          <a href="products.html" class="category-card">
            <div class="icon-box"><i class="fas fa-carrot"></i></div>
            <h3>Vegetables</h3>
          </a>
          <a href="products.html" class="category-card">
            <div class="icon-box"><i class="fas fa-apple-alt"></i></div>
            <h3>Fruits</h3>
          </a>
          <a href="products.html" class="category-card">
            <div class="icon-box"><i class="fas fa-seedling"></i></div>
            <h3>Spices</h3>
          </a>
          <a href="products.html" class="category-card">
            <div class="icon-box"><i class="fas fa-bowl-rice"></i></div>
            <h3>Rice & Grains</h3>
          </a>
        </div>
      </div>
    </section>

    <section class="why-choose-us">
      <div class="container">
        <h2 class="section-title">Why Shop With Us?</h2>
        <div class="features-grid">
          <div class="feature-card">
            <i class="fas fa-tractor"></i>
            <h3>Farm Fresh</h3>
            <p>Directly from local farms & artisans.</p>
          </div>
          <div class="feature-card">
            <i class="fas fa-truck-fast"></i>
            <h3>Fast Delivery</h3>
            <p>Reliable delivery across the island.</p>
          </div>
          <div class="feature-card">
            <i class="fas fa-medal"></i>
            <h3>Quality Guaranteed</h3>
            <p>Only the best freshness for you.</p>
          </div>
          <div class="feature-card">
            <i class="fas fa-users"></i>
            <h3>Community Support</h3>
            <p>Supporting local Sri Lankan communities.</p>
          </div>
        </div>
      </div>
    </section>

    <section class="faq-section">
      <div class="container">
        <h2 class="section-title">Frequently Asked Questions</h2>
        
        <div class="faq-container">
          <div class="faq-item">
            <button class="faq-question">
              Where do you deliver? <i class="fas fa-chevron-down"></i>
            </button>
            <div class="faq-answer">
              <p>We can deliver to any place in Sri Lanka. Orders placed before 9 AM are delivered the same day.</p>
            </div>
          </div>

          <div class="faq-item">
            <button class="faq-question">
              Is the produce organic? <i class="fas fa-chevron-down"></i>
            </button>
            <div class="faq-answer">
              <p>Yes! We source directly from certified organic farmers in Nuwara Eliya and Bandarawela.</p>
            </div>
          </div>

          <div class="faq-item">
            <button class="faq-question">
              What payment methods do you accept? <i class="fas fa-chevron-down"></i>
            </button>
            <div class="faq-answer">
              <p>We accept Cash on Delivery (COD) and Bank Transfers. Card payments are coming soon!</p>
            </div>
          </div>
        </div>
      </div>
    </section>

  </main>

  <footer>
    <div class="container">
      <div class="newsletter-wrapper">
        <div class="newsletter-text">
          <h3>Subscribe & Get 10% Off</h3>
          <p>Join our green family for fresh updates, recipes, and exclusive offers.</p>
        </div>
        <form class="newsletter-form" id="newsletter-form">
          <input type="email" placeholder="Enter your email address" required>
          <button type="submit">Subscribe</button>
        </form>
      </div>

      <div class="footer-divider"></div>

      <div class="footer-content">
        <p>Â© 2025 Lanka-Mart | Freshness You Can Trust</p>
        <div class="social-links">
          <a href="#"><i class="fab fa-facebook-f"></i></a>
          <a href="#"><i class="fab fa-instagram"></i></a>
          <a href="#"><i class="fab fa-whatsapp"></i></a>
        </div>
      </div>
    </div>
  </footer>

  <a href="https://wa.me/94771708215" class="float-whatsapp" target="_blank">
    <i class="fab fa-whatsapp"></i>
    <span class="tooltip-text">Chat with us!</span>
  </a>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
    import { getFirestore, doc, updateDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
    import { firebaseConfig } from './config.js';
    
    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    let currentUser = null;

    // Auth Listener
    onAuthStateChanged(auth, (user) => {
      if (user) {
        currentUser = user;
        const loginLink = document.querySelector('.login-link'); 
      } 
    });

    // Newsletter Logic
    document.getElementById('newsletter-form').addEventListener('submit', async function(e) {
      e.preventDefault();
      if (currentUser) {
        try {
          const userRef = doc(db, "users", currentUser.uid);
          await updateDoc(userRef, {
            newsletterSubscribed: true,
            hasDiscount: true,
            discountCode: "FRESH10"
          });
          alert(`Thanks ${currentUser.email}! The 10% discount (FRESH10) has been saved to your account.`);
          this.reset();
        } catch (error) {
          console.error("Error saving discount:", error);
          alert("Error saving discount.");
        }
      } else {
        alert("Please LOGIN first to save this 10% discount to your account!");
        window.location.href = "login.html";
      }
    });

    // --- MOBILE MENU LOGIC ---
    const hamburger = document.getElementById('hamburger');
    const navLinks = document.getElementById('navLinks');
    const navLinksItems = document.querySelectorAll('.nav-links a');

    if(hamburger && navLinks) {
      hamburger.addEventListener('click', () => {
        // Toggle Active Class
        navLinks.classList.toggle('active');
        
        // Toggle Icon (Bars <-> X)
        const icon = hamburger.querySelector('i');
        if (navLinks.classList.contains('active')) {
          icon.classList.remove('fa-bars');
          icon.classList.add('fa-times');
        } else {
          icon.classList.remove('fa-times');
          icon.classList.add('fa-bars');
        }
      });

      // Close menu when clicking a link
      navLinksItems.forEach(link => {
        link.addEventListener('click', () => {
           navLinks.classList.remove('active');
           const icon = hamburger.querySelector('i');
           icon.classList.remove('fa-times');
           icon.classList.add('fa-bars');
        });
      });
    }

    // FAQ Accordion
    const faqs = document.querySelectorAll(".faq-question");
    faqs.forEach(faq => {
      faq.addEventListener("click", () => {
        faq.classList.toggle("active");
        const answer = faq.nextElementSibling;
        if (faq.classList.contains("active")) {
          answer.style.maxHeight = answer.scrollHeight + "px";
        } else {
          answer.style.maxHeight = null;
        }
      });
    });
  </script>

  <script type="module" src="auth.js"></script>
</body>
</html>